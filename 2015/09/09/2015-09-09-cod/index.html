<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">




  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link rel="stylesheet" href="/lib/pace/pace-theme-big-counter.min.css?v=1.0.2">















  
  
  <link rel="stylesheet" href="/lib/fancybox/source/jquery.fancybox.css">







<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.1.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-next.png?v=7.1.2">


  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32-next.png?v=7.1.2">


  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16-next.png?v=7.1.2">


  <link rel="mask-icon" href="/images/logo.svg?v=7.1.2" color="#222">


  <link rel="manifest" href="/manifest.json">


  <meta name="msapplication-config" content="/browserconfig.xml">





<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.1.2',
    sidebar: {"position":"right","display":"post","offset":12,"onmobile":false,"dimmer":false,"b2t":false,"scrollpercent":true},
    back2top: true,
    back2top_sidebar: false,
    fancybox: true,
    fastclick: true,
    lazyload: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="《Computer Organization and Design, Hardware/Software Interface》以及《Computer Architecture: A Quantitative Approach》被誉为体系结构界的两本圣经。 最近除了编译原理外，还在补的就是《硬件/软件接口》这一本了。 这本书讲解得非常透彻。原本我只是对体系结构、CPU有个模糊的很难学的概念，，，书中">
<meta name="keywords" content="学习笔记,体系结构,组成与设计.硬软件接口">
<meta property="og:type" content="article">
<meta property="og:title" content="计算机组成与设计.硬件&#x2F;软件接口 学习笔记（一）">
<meta property="og:url" content="http://jcf94.com/2015/09/09/2015-09-09-cod/index.html">
<meta property="og:site_name" content="Chenfan Blog">
<meta property="og:description" content="《Computer Organization and Design, Hardware/Software Interface》以及《Computer Architecture: A Quantitative Approach》被誉为体系结构界的两本圣经。 最近除了编译原理外，还在补的就是《硬件/软件接口》这一本了。 这本书讲解得非常透彻。原本我只是对体系结构、CPU有个模糊的很难学的概念，，，书中">
<meta property="og:locale" content="en">
<meta property="og:image" content="http://jcf94.com/download/2015-09-09-cod-chip.png">
<meta property="og:image" content="http://jcf94.com/download/2015-09-09-cod-multi.png">
<meta property="og:image" content="http://jcf94.com/download/2015-09-09-cod-divi.png">
<meta property="og:image" content="http://jcf94.com/download/2015-09-09-cod-3.5.1.jpg">
<meta property="og:image" content="http://jcf94.com/download/2015-09-09-cod-3.5.2.jpg">
<meta property="og:image" content="http://jcf94.com/download/2015-09-09-cod-3.5.3.jpg">
<meta property="og:updated_time" content="2018-10-04T02:46:34.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="计算机组成与设计.硬件&#x2F;软件接口 学习笔记（一）">
<meta name="twitter:description" content="《Computer Organization and Design, Hardware/Software Interface》以及《Computer Architecture: A Quantitative Approach》被誉为体系结构界的两本圣经。 最近除了编译原理外，还在补的就是《硬件/软件接口》这一本了。 这本书讲解得非常透彻。原本我只是对体系结构、CPU有个模糊的很难学的概念，，，书中">
<meta name="twitter:image" content="http://jcf94.com/download/2015-09-09-cod-chip.png">



  <link rel="alternate" href="/atom.xml" title="Chenfan Blog" type="application/atom+xml">



  
  
  <link rel="canonical" href="http://jcf94.com/2015/09/09/2015-09-09-cod/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>计算机组成与设计.硬件/软件接口 学习笔记（一） | Chenfan Blog</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-right page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Chenfan Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <h1 class="site-subtitle" itemprop="description">Do cool things that matter.</h1>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>Categories</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>Tags</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>About</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-links">

    
    
    
      
    

    

    <a href="/links/" rel="section"><i class="menu-item-icon fa fa-fw fa-link"></i> <br>Links</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-paper-reading">

    
    
    
      
    

    

    <a href="/2017/08/18/2017-08-18-paper/" rel="section"><i class="menu-item-icon fa fa-fw fa-bookmark"></i> <br>Paper Reading</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>Search</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="Searching..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jcf94.com/2015/09/09/2015-09-09-cod/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jcf94">
      <meta itemprop="description" content="To live is to change the world.">
      <meta itemprop="image" content="/photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chenfan Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">计算机组成与设计.硬件/软件接口 学习笔记（一）

              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2015-09-09 10:56:01" itemprop="dateCreated datePublished" datetime="2015-09-09T10:56:01+08:00">2015-09-09</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018-10-04 10:46:34" itemprop="dateModified" datetime="2018-10-04T10:46:34+08:00">2018-10-04</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Computer-Architecture/" itemprop="url" rel="index"><span itemprop="name">Computer Architecture</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2015/09/09/2015-09-09-cod/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count gitment-comments-count" data-xid="/2015/09/09/2015-09-09-cod/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="post-meta-item-icon">
            <i class="fa fa-eye"></i>
             Views:  
            <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>
            </span>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>《Computer Organization and Design, Hardware/Software Interface》以及《Computer Architecture: A Quantitative Approach》被誉为体系结构界的两本圣经。</p>
<p>最近除了编译原理外，还在补的就是《硬件/软件接口》这一本了。</p>
<p>这本书讲解得非常透彻。原本我只是对体系结构、CPU有个模糊的很难学的概念，，，书中由浅至深详细地解释了其中的工作原理，，，，真的好难啊Q_Q…</p>
<blockquote>
<p>2018-02-02</p>
<p>当时还剩下最后一章的一点东西没看，回来把这些内容看完。</p>
<p>算是在这个方面做了这么久的工作，对里面的好多东西也都有了新的理解，顺便重新整理一下。</p>
</blockquote>
<a id="more"></a>

<p>本书的官方主页：<a href="http://booksite.elsevier.com/9780124077263/index.php" target="_blank" rel="noopener">Elsevier Store</a></p>
<p>笔记的内容基本上按照目录，这一篇记的是前三章的主要内容。</p>
<h1 id="CHAPTER-1-Computer-Abstractions-and-Technology"><a href="#CHAPTER-1-Computer-Abstractions-and-Technology" class="headerlink" title="CHAPTER 1. Computer Abstractions and Technology"></a>CHAPTER 1. Computer Abstractions and Technology</h1><h2 id="1-1-Instruction"><a href="#1-1-Instruction" class="headerlink" title="1.1. Instruction"></a>1.1. Instruction</h2><h2 id="1-2-Eight-Great-Ideas-in-Computer-Architecture"><a href="#1-2-Eight-Great-Ideas-in-Computer-Architecture" class="headerlink" title="1.2. Eight Great Ideas in Computer Architecture"></a>1.2. Eight Great Ideas in Computer Architecture</h2><p>计算机系统结构中的八个 Great Ideas</p>
<blockquote>
<p>其实系统结构设计发展这么多年了，很多核心的设计思想本质上都是几个基本原理。</p>
</blockquote>
<ul>
<li>Design for Moore’s Law</li>
</ul>
<p>系统结构设计的周期通常都比较长，由于摩尔定律的存在，很有可能项目开始时和项目结束时能够提供的原件在工艺方面的性能就有很大的差距了，因此做系统结构设计需要考虑到这方面的因素。</p>
<p>话说 Intel 每年的 CPU 升级战略也有一点这个意思，“Tick-Tock”一年升级工艺制程，一年升级架构设计。</p>
<blockquote>
<p>然后到了 2017 年，摩尔定律开始唱衰了，各方都开始吹摩尔定律要走到头了，一大波人转而去搞领域专用的 ASIC 芯片设计去了。</p>
</blockquote>
<ul>
<li>Use Abstraction to Simplify Design</li>
</ul>
<p>分层次进行设计，底层的细节对上层不透明，意思就是上层不用去管底层里面是怎么做的，只要给我想要的接口就好了。</p>
<p>其实也就是模块化。这样做的好处是，比如做某一层工作的人可以专心钻在那层里面，在自己的范围内做改进啊做优化啊，不用去管别人的工作需要做什么。</p>
<blockquote>
<p>当然层次分的太多，可能也会引起性能的下降，有的时候我们搞优化的反而就想要层次简单点，一波直通到底。</p>
</blockquote>
<ul>
<li>Make the Common Case Fast</li>
</ul>
<p>做优化要把工作放在 <strong>Common Case</strong> 上， 花大力气在 <strong>Rare Case</strong> 上就浪费了。另一方面要找到最耗时的点，找到瓶颈所在才有用。</p>
<p>那么哪些地方是 Common Case 呢？这就需要做针对性的测试来找出来了（见 Section 1.6）。</p>
<ul>
<li>Performance via Parallelism</li>
</ul>
<p>并行也没啥好说的，这几年的发展趋势就是硬件上单核往多核甚至众核走，算法上也都要往并行方面设计。</p>
<ul>
<li><strong>Performance via Pipelining</strong></li>
</ul>
<p>流水线是一个非常重要的思想，在硬件和软件的架构设计里面都能用的到。</p>
<p>多级流水可以提高资源利用率、隐藏延迟等等。</p>
<ul>
<li>Performance via Prediction</li>
</ul>
<p>这块主要指的是处理器指令预测、指令预取等等。</p>
<ul>
<li>Hierarchy of Memories</li>
</ul>
<p>存储器分级最突出的体现还是在 cache 上，现在主流的处理器上 cache 已经做到了 L3，可能过几年就有 L4 了。</p>
<ul>
<li>Dependability via Redundancy</li>
</ul>
<p>通过<strong>冗余设计</strong>来保证系统可靠性，这个主要是容灾备份的思想。</p>
<h2 id="1-3-Below-Your-Program"><a href="#1-3-Below-Your-Program" class="headerlink" title="1.3. Below Your Program"></a>1.3. Below Your Program</h2><p>这里有一句特别有意思的话：</p>
<blockquote>
<p>Just as the 26 letters of the English alphabet do not limit how much can be written, the two letters of the computer alphabet do not limit what computer can do.</p>
</blockquote>
<p>程序运行的过程：</p>
<p><code>高级语言</code>编译成<code>汇编语言（低级语言）</code>，再汇编成<code>机器语言</code>，然后硬件运行</p>
<h2 id="1-4-Under-the-Covers"><a href="#1-4-Under-the-Covers" class="headerlink" title="1.4. Under the Covers"></a>1.4. Under the Covers</h2><p>这一节拿 iPad2 简单介绍了一下硬件实现。在电子元件的层面，无论是屏幕显示还是计算都是 0 和 1，从元件往上开始就涉及到了前面说的抽象思想了，<strong>指令集</strong>就是对机器码实现的抽象。</p>
<h2 id="1-5-Technologies-for-Building-Processors-and-Memory"><a href="#1-5-Technologies-for-Building-Processors-and-Memory" class="headerlink" title="1.5. Technologies for Building Processors and Memory"></a>1.5. Technologies for Building Processors and Memory</h2><p>电子元件的发展演变：</p>
<table>
<thead>
<tr>
<th>年份</th>
<th>电子元件技术</th>
<th>单位资源消耗能得到的相对性能</th>
</tr>
</thead>
<tbody><tr>
<td>1951</td>
<td>电子管</td>
<td>1</td>
</tr>
<tr>
<td>1965</td>
<td>晶体管</td>
<td>35</td>
</tr>
<tr>
<td>1975</td>
<td>集成电路</td>
<td>900</td>
</tr>
<tr>
<td>1995</td>
<td>（Very）大规模集成电路</td>
<td>2,400,000</td>
</tr>
<tr>
<td>2013</td>
<td>（Ultra）超大规模集成电路</td>
<td>250,000,000,000</td>
</tr>
</tbody></table>
<p>话说理论上来说从 1965 年一直到现在本质上用的原件都还是晶体管，只不过工艺水平一直在提升，集成度也在不断增加，摩尔定律本质上是对单块芯片里面晶体管数量增长率的估计。</p>
<p>来看下 CPU 这些芯片是怎么造出来的：</p>
<p><img src="http://jcf94.com/download/2015-09-09-cod-chip.png" alt></p>
<p>首先原料是从硅开始，硅是一种出色的半导体材料，它本身的导电性介于导体和绝缘体之间，但是经过某些化学处理之后，可以变成三种不同性质的结构：</p>
<ol>
<li>用微观铜线或者铝线（microscopic copper or aluminum wire，不知道这个具体处理过程是啥）处理之后，可以变成良导体</li>
<li>绝缘体</li>
<li>可控进行导电或者不导电，起到开关的作用（晶体管）</li>
</ol>
<p>把纯的单晶硅熔化了，从里面拉出来硅锭（silicon crystal ingot）；硅锭是圆柱形的，对其进行横向切片，得到了厚度小于 0.1 英寸的晶圆（wafers）；然后经过 20<del>40 道工序的化学处理，就把晶圆上的不同位置变成了前面说的三种结构，要么导电、要么不导电、要么变成晶体管，这个过程也就是电路蚀刻（现在的半导体工艺已经做到了单层晶体管，2</del>8 层用绝缘体隔开的导体结构）。</p>
<p>电路蚀刻的过程非常复杂，由于工序太多，而且中间都是各种物理化学反应，很难做到一整个晶圆上的电路都是完美的，所以芯片制造工艺从一开始就考虑了这一点，一个晶圆上蚀刻了很多片（dies）芯片（chips）。这样虽然很难保证整块晶圆上的电路都是完美的，但是切出来的单块芯片是完美的的可能性还是很大的。后续就是对这些芯片做测试，通过测试的再封装上外围电路等等，就生产出来完整的 CPU 了。</p>
<p>封装这件事情上面还有个比较有趣的点。同代的某种型号的 i7、i5、i3 有可能出自同一个晶圆！！！完美的芯片做成 i7，有瑕疵然后测试挂了几个核的就封装的时候关掉几个核做成 i5，瑕疵更多挂了更多个核的就封装成 i3。</p>
<p>一些资料：</p>
<ul>
<li><a href="https://zhuanlan.zhihu.com/p/29743431" target="_blank" rel="noopener">CPU制造的那些事之一：i7和i5其实是孪生兄弟！？</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/29767262" target="_blank" rel="noopener">CPU制造的那些事之二：Die的大小和良品率</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/30513730" target="_blank" rel="noopener">为什么晶圆都是圆的不是方的？</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/30549356" target="_blank" rel="noopener">为什么”电路”要铺满整个晶圆？</a></li>
</ul>
<h2 id="1-6-Performance"><a href="#1-6-Performance" class="headerlink" title="1.6. Performance"></a>1.6. Performance</h2><p>两个需要区别开的概念：</p>
<ul>
<li>wall clock time、response time、elapsed time：指的都是跑一个任务实际花费的时间，包含了 I/O 啊，访存啊，操作系统 overhead 啊等等等等，相当于用秒表记出来的时间；</li>
<li>CPU execution time、CPU time：指的是 CPU 跑这个任务消耗的时间，实际上对应的是 CPU 跑了多少个时钟周期，里面不包含其他部分消耗所花费的时间（I/O，线程切换等等其他这些）。</li>
</ul>
<p>后面说系统性能针对的时间计量方式是前者，而 CPU 性能针对的时间计算方式是后者。</p>
<blockquote>
<p>面向某个具体的优化任务时，要考虑清楚要用哪种方式来计量。优化要达到的性能指标跟性能定义是直接相关的，也需要针对具体的指标来找出性能瓶颈所在。</p>
</blockquote>
<p>性能的定义：</p>
<p>$$性能_X=\frac{1}{运行时间_X}$$</p>
<p>X比Y快n倍：</p>
<p>$$\frac{性能_X}{性能_Y}=\frac{运行时间_Y}{运行时间_X}=n$$</p>
<p>CPU运行时间/CPU时间：</p>
<p>$$CPU运行时间=CPU时钟周期数*时钟周期时间=\frac{CPU时钟周期数}{时钟频率（主频）}$$</p>
<p>CPI（时钟周期/指令）：</p>
<p>$$CPU时钟周期数=指令数*CPI$$</p>
<p>$$CPU运行时间=指令数*CPI*时钟周期时间=\frac{指令数*CPI}{时钟频率}$$</p>
<h2 id="1-7-The-Power-Wall"><a href="#1-7-The-Power-Wall" class="headerlink" title="1.7. The Power Wall"></a>1.7. The Power Wall</h2><p>功耗与主频几乎是同等上升的，主频越高功耗越高。前期主频提升很快，而最近一个阶段，处理器的主频基本不再提升，因为功耗已经达到了一个相当高的程度，在散热等其他方面还没办法跟上的时候只能限制主频的提升。</p>
<ul>
<li>动态功耗</li>
</ul>
<p>CPU 的功耗主要是动态功耗，来源于晶体管的开关切换，即高低电平（0 和 1）之间的翻转，这中间本质上是个充放电的过程，所以这部分能量消耗是无法避免的：</p>
<p>$$动态功耗\propto *电容性负载*电压^2*开关频率$$</p>
<p>动态功耗与主频成正比，与电压的平方成正比。</p>
<ul>
<li>静态功耗</li>
</ul>
<p>静态功耗主要来自于晶体管的漏电流，也几乎是无法避免的，只能通过工艺改进来减少。</p>
<p>一些资料：</p>
<ul>
<li><a href="/2016/05/07/2016-05-07-icpower">【转】功耗对处理器的限制究竟有多大？</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/30409360" target="_blank" rel="noopener">为什么CPU的频率止步于4G?我们触到频率天花板了吗？</a></li>
</ul>
<h2 id="1-8-The-Sea-Change-The-Switch-from-Uniprocessors-to-Multiprocessors"><a href="#1-8-The-Sea-Change-The-Switch-from-Uniprocessors-to-Multiprocessors" class="headerlink" title="1.8. The Sea Change: The Switch from Uniprocessors to Multiprocessors"></a>1.8. The Sea Change: The Switch from Uniprocessors to Multiprocessors</h2><p>受到工艺、功耗等的限制，单纯地提升主频来提高处理器的性能已经是做不到了，因此转向提高处理器的并行能力来继续发展CPU，即往一个芯片中集成更多的处理核心，而从单核开始向多核转变。</p>
<p>之前由于性能的提升主要在工艺、硬件层面，对于软件来说影响很小，但是多核处理器出现之后，也推动了并行算法的发展，因为只有从算法上进行改进才能够更好地利用上多核处理的优势。</p>
<h2 id="1-9-Real-Stuff-Benchmarking-the-Intel-Core-i7"><a href="#1-9-Real-Stuff-Benchmarking-the-Intel-Core-i7" class="headerlink" title="1.9. Real Stuff: Benchmarking the Intel Core i7"></a>1.9. Real Stuff: Benchmarking the Intel Core i7</h2><p>实例：Intel Core i7的基准测试</p>
<h2 id="1-12-Historial-Perspectives-and-Further-Reading"><a href="#1-12-Historial-Perspectives-and-Further-Reading" class="headerlink" title="1.12. Historial Perspectives and Further Reading"></a>1.12. Historial Perspectives and Further Reading</h2><p><a href="http://booksite.elsevier.com/9780124077263/downloads/historial%20perspectives/section_1.12.pdf" target="_blank" rel="noopener">PDF材料</a></p>
<h2 id="1-13-Exercises"><a href="#1-13-Exercises" class="headerlink" title="1.13. Exercises"></a>1.13. Exercises</h2><p><a href="http://jcf94.com/download/2015-09-09-cod-CH01_Solution.pdf">答案</a></p>
<hr>
<h1 id="CHAPTER-2-Instructions-Language-of-the-Computer"><a href="#CHAPTER-2-Instructions-Language-of-the-Computer" class="headerlink" title="CHAPTER 2. Instructions: Language of the Computer"></a>CHAPTER 2. Instructions: Language of the Computer</h1><p>第二章主要是以 MIPS 为例，介绍计算机指令。</p>
<h2 id="2-1-Instruction"><a href="#2-1-Instruction" class="headerlink" title="2.1. Instruction"></a>2.1. Instruction</h2><h2 id="2-2-Operations-of-the-Computer-Hardware"><a href="#2-2-Operations-of-the-Computer-Hardware" class="headerlink" title="2.2. Operations of the Computer Hardware"></a>2.2. Operations of the Computer Hardware</h2><p>设计原则1：简单有助于规整</p>
<p>定义一些基本的操作，再用基本的操作来组成复杂操作。</p>
<h2 id="2-3-Operands-of-the-Computer-Hardware"><a href="#2-3-Operands-of-the-Computer-Hardware" class="headerlink" title="2.3. Operands of the Computer Hardware"></a>2.3. Operands of the Computer Hardware</h2><p>设计原则2：越少越快</p>
<p>为了保证每个寄存器的读取速度，寄存器数量不能太多。</p>
<h2 id="2-4-Signed-and-Unsigned-Numbers"><a href="#2-4-Signed-and-Unsigned-Numbers" class="headerlink" title="2.4. Signed and Unsigned Numbers"></a>2.4. Signed and Unsigned Numbers</h2><h2 id="2-5-Representing-Instructions-in-the-Computer"><a href="#2-5-Representing-Instructions-in-the-Computer" class="headerlink" title="2.5. Representing Instructions in the Computer"></a>2.5. Representing Instructions in the Computer</h2><p>设计原则3：好的设计需要适宜的折中方案</p>
<p>计算机指令的设计需要考虑到指令长度等等一系列复杂的因素。</p>
<h2 id="2-6-Logical-Operations"><a href="#2-6-Logical-Operations" class="headerlink" title="2.6. Logical Operations"></a>2.6. Logical Operations</h2><h2 id="2-7-Instructions-for-Making-Decisions"><a href="#2-7-Instructions-for-Making-Decisions" class="headerlink" title="2.7. Instructions for Making Decisions"></a>2.7. Instructions for Making Decisions</h2><h2 id="2-8-Supporting-Procedures-in-Computer-Hardware"><a href="#2-8-Supporting-Procedures-in-Computer-Hardware" class="headerlink" title="2.8. Supporting Procedures in Computer Hardware"></a>2.8. Supporting Procedures in Computer Hardware</h2><p>函数和过程的实现，主要通过地址跳转和堆栈来完成。</p>
<h2 id="2-9-MIPS-Addressing-for-32-Bit-Immediates-and-Addresses"><a href="#2-9-MIPS-Addressing-for-32-Bit-Immediates-and-Addresses" class="headerlink" title="2.9. MIPS Addressing for 32-Bit Immediates and Addresses"></a>2.9. MIPS Addressing for 32-Bit Immediates and Addresses</h2><p>32位立即数和地址的MIPS编址</p>
<table>
<thead>
<tr>
<th></th>
<th>说明</th>
<th>op</th>
<th>rs</th>
<th>rt</th>
<th>rd</th>
<th>shamt</th>
<th>funct</th>
<th>address</th>
</tr>
</thead>
<tbody><tr>
<td>R-format</td>
<td>算术/寄存器操作</td>
<td>6位</td>
<td>5位</td>
<td>5位</td>
<td>5位</td>
<td>5位</td>
<td>6位</td>
<td></td>
</tr>
<tr>
<td>I-format</td>
<td>转移/分支/立即数操作</td>
<td>6位</td>
<td>5位</td>
<td>5位</td>
<td></td>
<td></td>
<td></td>
<td>16位</td>
</tr>
<tr>
<td>J-format</td>
<td>跳转操作</td>
<td>6位</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>26位</td>
</tr>
</tbody></table>
<p>条件转移范围：<br>16位地址码，但是MIPS中是按4字节寻址，即实际上可以表示18位的地址<br>18位首位为符号位，即可跳转到当前PC位置的$(-32K\sim32K-1)*4=-128K\sim(128K-4)$字节</p>
<p>立即数范围：<br>与上同理，都属于I-format的指令，因此可表示的立即数范围为$-32K\sim32K-1$</p>
<p>跳转指令范围：<br>26位地址码，4字节寻址，实际可表示28位地址<br>28位为无符号数地址，可跳转到$(0\sim2^{26}-1)*4=0\sim(256M-4)$字节</p>
<h2 id="2-10-Parallelism-and-Instructions-Synchronization"><a href="#2-10-Parallelism-and-Instructions-Synchronization" class="headerlink" title="2.10. Parallelism and Instructions: Synchronization"></a>2.10. Parallelism and Instructions: Synchronization</h2><p>并行编程的指令中最重要的是原子操作，即多个不同进程之间的同步。</p>
<p>这里介绍了一下 ll（load link）和sc（store conditional）指令。</p>
<h2 id="2-11-Translating-and-Starting-a-Program"><a href="#2-11-Translating-and-Starting-a-Program" class="headerlink" title="2.11. Translating and Starting a Program"></a>2.11. Translating and Starting a Program</h2><p>高级语言编译成汇编语言，再汇编成机器码的二进制对象，之后链接上一些必要的库文件（也是机器码二进制对象），最终才得到了机器码的二进制可执行文件，然后 load 到内存里运行。</p>
<h2 id="2-12-A-C-Sort-Example-to-Put-It-All-Together"><a href="#2-12-A-C-Sort-Example-to-Put-It-All-Together" class="headerlink" title="2.12. A C Sort Example to Put It All Together"></a>2.12. A C Sort Example to Put It All Together</h2><p>一个C语言的排序示例</p>
<h2 id="2-13-Advanced-Material-Compiling-C"><a href="#2-13-Advanced-Material-Compiling-C" class="headerlink" title="2.13. Advanced Material: Compiling C"></a>2.13. Advanced Material: Compiling C</h2><p>提升材料：编译C语言</p>
<p><a href="http://booksite.elsevier.com/9780124077263/downloads/advance_contents_and_appendices/section_2.15.pdf" target="_blank" rel="noopener">PDF材料</a></p>
<h2 id="2-14-Real-Stuff-ARMv7-32-bit-Instructions"><a href="#2-14-Real-Stuff-ARMv7-32-bit-Instructions" class="headerlink" title="2.14. Real Stuff: ARMv7 (32-bit) Instructions"></a>2.14. Real Stuff: ARMv7 (32-bit) Instructions</h2><p>实例：ARMv7（32位）指令</p>
<h2 id="2-15-Real-Stuff-x86-Instructions"><a href="#2-15-Real-Stuff-x86-Instructions" class="headerlink" title="2.15. Real Stuff: x86 Instructions"></a>2.15. Real Stuff: x86 Instructions</h2><p>实例：x86指令</p>
<h2 id="2-16-Real-Stuff-ARMv8-64-bit-Instructions"><a href="#2-16-Real-Stuff-ARMv8-64-bit-Instructions" class="headerlink" title="2.16. Real Stuff: ARMv8 (64-bit) Instructions"></a>2.16. Real Stuff: ARMv8 (64-bit) Instructions</h2><p>实例：ARMv8（64位）指令</p>
<h2 id="2-19-Historial-Perspectives-and-Further-Reading"><a href="#2-19-Historial-Perspectives-and-Further-Reading" class="headerlink" title="2.19. Historial Perspectives and Further Reading"></a>2.19. Historial Perspectives and Further Reading</h2><p><a href="http://booksite.elsevier.com/9780124077263/downloads/historial%20perspectives/section_2.21.pdf" target="_blank" rel="noopener">PDF材料</a></p>
<h2 id="2-20-Exercises"><a href="#2-20-Exercises" class="headerlink" title="2.20. Exercises"></a>2.20. Exercises</h2><p><a href="http://jcf94.com/download/2015-09-09-cod-CH02_Solution.pdf">答案</a></p>
<hr>
<h1 id="CHAPTER-3-Arithmetic-for-Computers"><a href="#CHAPTER-3-Arithmetic-for-Computers" class="headerlink" title="CHAPTER 3. Arithmetic for Computers"></a>CHAPTER 3. Arithmetic for Computers</h1><p>计算机中的算术运算</p>
<h2 id="3-1-Instruction"><a href="#3-1-Instruction" class="headerlink" title="3.1. Instruction"></a>3.1. Instruction</h2><h2 id="3-2-Addition-and-Subtraction"><a href="#3-2-Addition-and-Subtraction" class="headerlink" title="3.2. Addition and Subtraction"></a>3.2. Addition and Subtraction</h2><p>加减的硬件实现考虑数电中的加减电路，原理还是很简单的。</p>
<h2 id="3-3-Multiplication"><a href="#3-3-Multiplication" class="headerlink" title="3.3. Multiplication"></a>3.3. Multiplication</h2><p>乘法的硬件实现也可以看成是用纸笔列竖式乘法方法的衍生，即移位和加法。</p>
<p><img src="http://jcf94.com/download/2015-09-09-cod-multi.png" alt></p>
<h2 id="3-4-Division"><a href="#3-4-Division" class="headerlink" title="3.4. Division"></a>3.4. Division</h2><p>移位加比较，原理类似。</p>
<p><img src="http://jcf94.com/download/2015-09-09-cod-divi.png" alt></p>
<h2 id="3-5-Floating-Point"><a href="#3-5-Floating-Point" class="headerlink" title="3.5. Floating Point"></a>3.5. Floating Point</h2><p>计算机中的实数用科学计数法来表示，将一个存储空间的一部分用于表示指数，另一部分用于表示尾数。</p>
<p>存储空间的总大小是一定的，指数数位越多，则表示的数的范围越大，但是由于尾数数位少了，有效数位下降了；反之，指数数位越少，表示的数有效数位越多，精确度越高，但是能够表示的范围就小了。</p>
<p>以MIPS中常见的32位浮点数表示为例：</p>
<img src="http://jcf94.com/download/2015-09-09-cod-3.5.1.jpg" title="MIPS中常见的浮点数表示法">

<p>首位为符号位，接下来8位是带符号的指数部分，最后23位是尾数，则整个数最后表示的内容是：</p>
<p>$$(-1)^S*F*2^E$$</p>
<p>它能表示的范围在：$2*10^{-38}\sim2*10^{38}$</p>
<p>64位的浮点数结构则是这样的：</p>
<img src="http://jcf94.com/download/2015-09-09-cod-3.5.2.jpg" title="双精度浮点数表示">

<p>表示的范围在：$2*10^{-308}\sim2*10^{308}$</p>
<hr>
<p>IEEE754标准对零、无穷与无效数据格式作了规定：</p>
<img src="http://jcf94.com/download/2015-09-09-cod-3.5.3.jpg" title="IEEE754浮点数编码">

<p>除此之外，对浮点数有两个比较重要的规定：</p>
<ol>
<li>忽略尾数的前导1</li>
<li>指数带偏阶</li>
</ol>
<p>标准格式的10进制科学计数法中，整数位一定是个介于1~9之间的数，否则就可进一步进行标准化，把多出来的数位算到指数上去。</p>
<p>那么2进制的科学计数法也是一样的道理。因此尾数第1个数位一定是1，则约定俗成的，若是隐藏这个前导1，实际可以多表示一位数位。</p>
<p>指数的偏阶是为了避免一个看上去似乎是很大的数，因为指数是负数，而结果很小的情况。</p>
<p>32位浮点数中，默认将阶数加上127作为存储的指数。</p>
<p>这样$128_{10}=10000000_2$的指数实际上表示1；而$0_{10}=00000000_2$实际上表示-127。</p>
<p>则最终，实际上浮点数的表示是：</p>
<p>$$(-1)^S*(1+F)*2^{E-Bias}$$</p>
<h2 id="3-6-Parallelism-and-Computer-Arithmetic-Subword-Parallelism"><a href="#3-6-Parallelism-and-Computer-Arithmetic-Subword-Parallelism" class="headerlink" title="3.6. Parallelism and Computer Arithmetic: Subword Parallelism"></a>3.6. Parallelism and Computer Arithmetic: Subword Parallelism</h2><p>处理图像和声音等等数据时，可能会有一堆类似的操作一起出现，考虑并行处理。</p>
<p>这里的子字并行（subword parallelism）这个词其实就是平常更常说的向量化或者 SIMD。就是一条指令对一组数据进行相同的操作。</p>
<h2 id="3-7-Real-Stuff-Streaming-SIMD-Extensions-and-Advanced-Vector-Extensions-in-x86"><a href="#3-7-Real-Stuff-Streaming-SIMD-Extensions-and-Advanced-Vector-Extensions-in-x86" class="headerlink" title="3.7. Real Stuff: Streaming SIMD Extensions and Advanced Vector Extensions in x86"></a>3.7. Real Stuff: Streaming SIMD Extensions and Advanced Vector Extensions in x86</h2><p>实例：x86中的SIMD流扩展和高级向量扩展</p>
<h2 id="3-8-Going-Faster-Subword-Parallelism-and-Matrix-Multiply"><a href="#3-8-Going-Faster-Subword-Parallelism-and-Matrix-Multiply" class="headerlink" title="3.8. Going Faster: Subword Parallelism and Matrix Multiply"></a>3.8. Going Faster: Subword Parallelism and Matrix Multiply</h2><p>DGEMM: Double precision GEneral Matrix Multiply</p>
<p>对比了x86架构中 scalar double 与 parallel double 两种指令集的性能。其中 parallel double 在运算时执行的是并行的浮点乘法运算（SIMD）。</p>
<p>优化前性能：1.7GFLOPS<br>优化后性能：6.4GFLOPS</p>
<h2 id="3-11-Historial-Perspectives-and-Further-Reading"><a href="#3-11-Historial-Perspectives-and-Further-Reading" class="headerlink" title="3.11. Historial Perspectives and Further Reading"></a>3.11. Historial Perspectives and Further Reading</h2><p><a href="http://booksite.elsevier.com/9780124077263/downloads/historial%20perspectives/section_3.11.pdf" target="_blank" rel="noopener">PDF材料</a></p>
<h2 id="3-12-Exercises"><a href="#3-12-Exercises" class="headerlink" title="3.12. Exercises"></a>3.12. Exercises</h2><p><a href="http://jcf94.com/download/2015-09-09-cod-CH03_Solution.pdf">答案</a></p>
<hr>
<p>后接下一部分：</p>
<ul>
<li><a href="/2018/02/06/2018-02-06-cod2/">计算机组成与设计.硬件/软件接口 学习笔记（二）</a></li>
</ul>

      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/学习笔记/" rel="tag"># 学习笔记</a>
          
            <a href="/tags/体系结构/" rel="tag"># 体系结构</a>
          
            <a href="/tags/组成与设计-硬软件接口/" rel="tag"># 组成与设计.硬软件接口</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/09/07/2015-09-07-nothing/" rel="next" title="杂记">
                <i class="fa fa-chevron-left"></i> 杂记
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/09/13/2015-09-13-Changchun-Online/" rel="prev" title="The 2015 ACM-ICPC Asia Regional Changchun Online">
                The 2015 ACM-ICPC Asia Regional Changchun Online <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  
    <div class="comments" id="comments">
      
        <div id="gitment-container"></div>
      
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/photo.jpg" alt="Jcf94">
            
              <p class="site-author-name" itemprop="name">Jcf94</p>
              <div class="site-description motion-element" itemprop="description">To live is to change the world.</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">157</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">19</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">164</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/jcf94" title="GitHub &rarr; https://github.com/jcf94" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="http://weibo.com/jcf94" title="Weibo &rarr; http://weibo.com/jcf94" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i>Weibo</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="http://www.zhihu.com/people/jcf94" title="Zhihu &rarr; http://www.zhihu.com/people/jcf94" rel="noopener" target="_blank"><i class="fa fa-fw fa-book"></i>Zhihu</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://cn.linkedin.com/in/jcf94/en" title="Linked-in &rarr; https://cn.linkedin.com/in/jcf94/en" rel="noopener" target="_blank"><i class="fa fa-fw fa-linkedin"></i>Linked-in</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#CHAPTER-1-Computer-Abstractions-and-Technology"><span class="nav-text">CHAPTER 1. Computer Abstractions and Technology</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-Instruction"><span class="nav-text">1.1. Instruction</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2-Eight-Great-Ideas-in-Computer-Architecture"><span class="nav-text">1.2. Eight Great Ideas in Computer Architecture</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-3-Below-Your-Program"><span class="nav-text">1.3. Below Your Program</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-4-Under-the-Covers"><span class="nav-text">1.4. Under the Covers</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-5-Technologies-for-Building-Processors-and-Memory"><span class="nav-text">1.5. Technologies for Building Processors and Memory</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-6-Performance"><span class="nav-text">1.6. Performance</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-7-The-Power-Wall"><span class="nav-text">1.7. The Power Wall</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-8-The-Sea-Change-The-Switch-from-Uniprocessors-to-Multiprocessors"><span class="nav-text">1.8. The Sea Change: The Switch from Uniprocessors to Multiprocessors</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-9-Real-Stuff-Benchmarking-the-Intel-Core-i7"><span class="nav-text">1.9. Real Stuff: Benchmarking the Intel Core i7</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-12-Historial-Perspectives-and-Further-Reading"><span class="nav-text">1.12. Historial Perspectives and Further Reading</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-13-Exercises"><span class="nav-text">1.13. Exercises</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CHAPTER-2-Instructions-Language-of-the-Computer"><span class="nav-text">CHAPTER 2. Instructions: Language of the Computer</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-Instruction"><span class="nav-text">2.1. Instruction</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-2-Operations-of-the-Computer-Hardware"><span class="nav-text">2.2. Operations of the Computer Hardware</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-3-Operands-of-the-Computer-Hardware"><span class="nav-text">2.3. Operands of the Computer Hardware</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-4-Signed-and-Unsigned-Numbers"><span class="nav-text">2.4. Signed and Unsigned Numbers</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-5-Representing-Instructions-in-the-Computer"><span class="nav-text">2.5. Representing Instructions in the Computer</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-6-Logical-Operations"><span class="nav-text">2.6. Logical Operations</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-7-Instructions-for-Making-Decisions"><span class="nav-text">2.7. Instructions for Making Decisions</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-8-Supporting-Procedures-in-Computer-Hardware"><span class="nav-text">2.8. Supporting Procedures in Computer Hardware</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-9-MIPS-Addressing-for-32-Bit-Immediates-and-Addresses"><span class="nav-text">2.9. MIPS Addressing for 32-Bit Immediates and Addresses</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-10-Parallelism-and-Instructions-Synchronization"><span class="nav-text">2.10. Parallelism and Instructions: Synchronization</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-11-Translating-and-Starting-a-Program"><span class="nav-text">2.11. Translating and Starting a Program</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-12-A-C-Sort-Example-to-Put-It-All-Together"><span class="nav-text">2.12. A C Sort Example to Put It All Together</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-13-Advanced-Material-Compiling-C"><span class="nav-text">2.13. Advanced Material: Compiling C</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-14-Real-Stuff-ARMv7-32-bit-Instructions"><span class="nav-text">2.14. Real Stuff: ARMv7 (32-bit) Instructions</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-15-Real-Stuff-x86-Instructions"><span class="nav-text">2.15. Real Stuff: x86 Instructions</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-16-Real-Stuff-ARMv8-64-bit-Instructions"><span class="nav-text">2.16. Real Stuff: ARMv8 (64-bit) Instructions</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-19-Historial-Perspectives-and-Further-Reading"><span class="nav-text">2.19. Historial Perspectives and Further Reading</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-20-Exercises"><span class="nav-text">2.20. Exercises</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CHAPTER-3-Arithmetic-for-Computers"><span class="nav-text">CHAPTER 3. Arithmetic for Computers</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-Instruction"><span class="nav-text">3.1. Instruction</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-Addition-and-Subtraction"><span class="nav-text">3.2. Addition and Subtraction</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-3-Multiplication"><span class="nav-text">3.3. Multiplication</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-4-Division"><span class="nav-text">3.4. Division</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-5-Floating-Point"><span class="nav-text">3.5. Floating Point</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-6-Parallelism-and-Computer-Arithmetic-Subword-Parallelism"><span class="nav-text">3.6. Parallelism and Computer Arithmetic: Subword Parallelism</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-7-Real-Stuff-Streaming-SIMD-Extensions-and-Advanced-Vector-Extensions-in-x86"><span class="nav-text">3.7. Real Stuff: Streaming SIMD Extensions and Advanced Vector Extensions in x86</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-8-Going-Faster-Subword-Parallelism-and-Matrix-Multiply"><span class="nav-text">3.8. Going Faster: Subword Parallelism and Matrix Multiply</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-11-Historial-Perspectives-and-Further-Reading"><span class="nav-text">3.11. Historial Perspectives and Further Reading</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-12-Exercises"><span class="nav-text">3.12. Exercises</span></a></li></ol></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2014 – <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jcf94</span>

  

  
</div>


  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.9.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.1.2</div>




        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="post-meta-item-icon">
      <i class="fa fa-user"></i>
    </span>
    <span class="site-uv" title="Total Visitors">
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="post-meta-divider">|</span>
  

  
    <span class="post-meta-item-icon">
      <i class="fa fa-eye"></i>
    </span>
    <span class="site-pv" title="Total Views">
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>





  



  






  















  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script src="/lib/fancybox/source/jquery.fancybox.pack.js"></script>


  


  <script src="/js/utils.js?v=7.1.2"></script>

  <script src="/js/motion.js?v=7.1.2"></script>



  
  


  <script src="/js/affix.js?v=7.1.2"></script>

  <script src="/js/schemes/pisces.js?v=7.1.2"></script>




  
  <script src="/js/scrollspy.js?v=7.1.2"></script>
<script src="/js/post-details.js?v=7.1.2"></script>



  


  <script src="/js/next-boot.js?v=7.1.2"></script>


  
  <script src="/js/js.cookie.js?v=7.1.2"></script>
  <script src="/js/scroll-cookie.js?v=7.1.2"></script>


  

  

  


  
    <!-- LOCAL: You can save these files to your site and update links -->

  
  <script src="https://cdn.jsdelivr.net/gh/theme-next/theme-next-gitment@1/gitmint.browser.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/theme-next/theme-next-gitment@1/default.css">
<!-- END LOCAL -->

<script>
  function renderGitment() {
    var gitment = new Gitmint({
      id: window.location.pathname,
      owner: 'jcf94',
      repo: 'blog-comments',
      
        lang: 'en' || navigator.language || navigator.systemLanguage || navigator.userLanguage,
      
      oauth: {
      
      
        client_secret: 'e697661132cf0936345a27b937f76074f55002be',
      
        client_id: '53c17a207b0eb9315f41'
      }
    });
    gitment.render('gitment-container');
  }

  
    renderGitment();
  
</script>

  


  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
  

  
  

  
    
      <script type="text/x-mathjax-config">
  

  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$', '$'], ['\\(', '\\)'] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      
      equationNumbers: {
        autoNumber: 'AMS'
      }
    }
  });
  MathJax.Hub.Register.StartupHook('TeX Jax Ready', function() {
    MathJax.InputJax.TeX.prefilterHooks.Add(function(data) {
      if (data.display) {
        var next = data.script.nextSibling;
        while (next && next.nodeName.toLowerCase() === '#text') { next = next.nextSibling }
        if (next && next.nodeName.toLowerCase() === 'br') { next.parentNode.removeChild(next) }
      }
    });
  });
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for (i = 0; i < all.length; i += 1) {
      document.getElementById(all[i].inputID + '-Frame').parentNode.className += ' has-jax';
    }
  });
</script>
<script src="//cdn.jsdelivr.net/npm/mathjax@2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    
  


  

  

  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>


  

  

  

  

  

  
<script>
  $('.highlight').not('.gist .highlight').each(function(i, e) {
    var $wrap = $('<div>').addClass('highlight-wrap');
    $(e).after($wrap);
    $wrap.append($('<button>').addClass('copy-btn').append('Copy').on('click', function(e) {
      var code = $(this).parent().find('.code').find('.line').map(function(i, e) {
        return $(e).text();
      }).toArray().join('\n');
      var ta = document.createElement('textarea');
      var yPosition = window.pageYOffset || document.documentElement.scrollTop;
      ta.style.top = yPosition + 'px'; // Prevent page scroll
      ta.style.position = 'absolute';
      ta.style.opacity = '0';
      ta.readOnly = true;
      ta.value = code;
      document.body.appendChild(ta);
      ta.select();
      ta.setSelectionRange(0, code.length);
      ta.readOnly = false;
      var result = document.execCommand('copy');
      
        if (result) $(this).text('Copied');
        else $(this).text('Copy failed');
      
      ta.blur(); // For iOS
      $(this).blur();
    })).on('mouseleave', function(e) {
      var $b = $(this).find('.copy-btn');
      setTimeout(function() {
        $b.text('Copy');
      }, 300);
    }).append(e);
  })
</script>


  

  

</body>
</html>
